<!DOCTYPE html>
<html>
    <head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">		
		<title>Examples – Map Interfaces 2012</title>
		<!-- Bootstrap -->
		<link href="../css/bootstrap.min.css" rel="stylesheet">
		<link href="../css/bootstrap-responsive.min.css" rel="stylesheet">
		<link href="../css/custom.css" rel="stylesheet">

		<!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
		<!--[if lt IE 9]>
		  <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->		

    </head>
    <body>
		<div class="navbar navbar-inverse navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</a>
					<a class="brand" href="#">Map Interfaces</a>
					<div class="nav-collapse collapse">
						<ul class="nav">
							<li><a href="../">Home</a></li>
							<li class="dropdown">
								<a href="#" class="dropdown-toggle" data-toggle="dropdown">Grundlagen <b class="caret"></b></a>
								<ul class="dropdown-menu">
									<li class="nav-header">Leaflet</li>
									<li><a href="leaflet-basic.html" class="active">Leaflet Setup</a></li>
									<li><a href="leaflet-providers.html">Kartenprovider</a></li>
									<li><a href="leaflet-markers.html">Marker setzen</a></li>
									<li><a href="leaflet-geojson.html">GeoJSON anzeigen</a></li>
									<li class="divider"></li>
									<li class="nav-header">CartoDB</li>
									<li><a href="cartodb-basic.html" class="notyet">CartoDB Grundlagen</a></li>
								</ul>
							</li>
						</ul>
						<!--						<form class="navbar-form pull-right">
													<input class="span2" type="text" placeholder="Email">
													<input class="span2" type="password" placeholder="Password">
													<button type="submit" class="btn">Sign in</button>
												</form>-->
					</div><!--/.nav-collapse -->
				</div>
			</div>
		</div>

		<div class="container">

			<!-- Main hero unit for a primary marketing message or call to action -->
			<div class="hero-unit">
				<h1>Leaflet GeoJSON</h1>
				<p><a href="http://www.geojson.org/geojson-spec.html">GeoJSON ist ein Format</a> zur schnellen Übertragung von Geodaten und wird häufig in Zusammenhang mit öffentlichen Softwareschnittstellen von Webdiensten wie FourSquare, Faceboox, Qype und anderen eingesetzt.</p>
				<!--<p><a class="btn btn-primary btn-large">Learn more &raquo;</a></p>-->
			</div>

			<div class="row">
				<div class="span12">
					<iframe class="map" src="leaflet-geojson-clean.html"></iframe>
				</div>
				<div class="span12">
					<a href="leaflet-geojson-clean.html">Nur das Beispiel anzeigen</a>
				</div>
			</div>
			<div class="row">
				<div class="span12">
					Ein ganz einfaches Setup für eine interaktive Karte mit Leaflet besteht aus einer HTML-Datei (beispielsweise index.html), einer JavaScript-Datei (bsp. map.js) und der Leaflet Bibliothek die man sich herunterladen kann.
				</div>
			</div>
			<div class="row">
				<div class="span12">
					index.html
				</div>				
				<div class="span12">
					<pre>&lt;!DOCTYPE html&gt;
&lt;html&gt;
	&lt;head&gt;
		&lt;meta charset=&quot;utf-8&quot;&gt;
		&lt;title&gt;Leaflet Basic Setup&lt;/title&gt;
		&lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;leaflet/dist/leaflet.css&quot;&gt;
		&lt;script type=&quot;text/javascript&quot; src=&quot;leaflet/dist/leaflet.js&quot;&gt;&lt;/script&gt;
		&lt;style&gt;
			html, body { margin:0; padding: 0; }
			#map { min-height: 400px; }
		&lt;/style&gt;
	&lt;/head&gt;
	&lt;body&gt;
		&lt;div id=&quot;map&quot;&gt;&lt;/div&gt;
		&lt;script type=&quot;text/javascript&quot; src=&quot;map.js&quot;&gt;&lt;/script&gt;
	&lt;/body&gt;
&lt;/html&gt;</<pre>
				</div>
			</div>
			<div class="row">
				<div class="span12">
					map.js
				</div>								
				<div class="span12">
					<pre>
/* Map Interfaces 2012 – FH Potsdam
 * 
 * Basic GeoJSON als Beispielprojekt
 * 
 * @author	Marcus Paeschke
 * @licence	cc-by-sa
 */

var cartodb_apikey = "[CartoDB-Key]";


/**
 * Step 1: Konfiguration unserer Karten-Layer
 */

var onEachFeature = function (feature, layer) {
	// Hier können wir eingreifen und Interaktionen hinzufügen, beispielsweise Popups
	if (feature.properties && feature.properties.name) {
		layer.bindPopup(feature.properties.name);
	}
}


var layer = {
	basemap1 : L.tileLayer('http://{s}.tile.cloudmade.com/[CloudMade-Key]/997/256/{z}/{x}/{y}.png'),
	basemap2 : L.tileLayer('http://{s}.tile.cloudmade.com/[CloudMade-Key]/999/256/{z}/{x}/{y}.png'),
	tiles : L.tileLayer('http://marcus.maps-fhp.de:8181/tiles/fhpinfrastructure/{z}/{x}/{y}.png?map_key=' + cartodb_apikey),
	geojson : L.geoJson(),
	geojsonInteractive : L.geoJson(null, {
		onEachFeature : onEachFeature
	})
}


/**
 * Step 2: Zuerst muss Leaflet initialisiert werden, der Einfachheit halber speichern wir das Objekt in der Variable "map"
 */
var map = L.map('map', {
	center : [52.4125, 13.051],
	zoom : 17,
	layers : [layer.basemap1, layer.geojson]
});

/**
 * Step 3: LayerSwitch, erst Konfiguration und dann das Objekt erstellen und der Karte hinzufügen
 */

layer.config = {
	base : {
		"Roadmap" : layer.basemap1,
		"Midnight" : layer.basemap2			
	},
	overlay : {
		"Simple GeoJSON" : layer.geojson,
		"Interactive GeoJSON": layer.geojsonInteractive,
		"Tiles" : layer.tiles
	}	
}

var layerswitch = L.control.layers(layer.config.base, layer.config.overlay).addTo(map);


/**
 * Using jQuery to load GeoJSON data
 */

$(document).ready(function () {
	var query = 'SELECT * FROM fhpinfrastructure';
	$.getJSON('http://marcus.maps-fhp.de:8080/api/v1/sql?format=GeoJSON&q=' + encodeURIComponent(query), function (data) {
		layer.geojson.addData(data);
		layer.geojsonInteractive.addData(data);
	});	
});
					</pre>
				</div>
			</div>
			
			<hr>

			<footer>
				<p>&copy; Interfacedesign · FH Potsdam · 2012</p>
			</footer>

		</div> <!-- /container -->



		<script src="http://code.jquery.com/jquery-latest.js"></script>
		<script src="../js/bootstrap.min.js"></script>


    </body>
</html>